import{b as L}from"./chunk-SCC7YKHJ.js";import"./chunk-YHCOF5QW.js";import"./chunk-ZWZ4B73B.js";import{a as z}from"./chunk-4GZSFRTA.js";import{a as J}from"./chunk-QHM3H5ES.js";import{b as U,d as k,e as E,h as B,i as T,k as V,m as N,n as I}from"./chunk-NLQUPEL3.js";import{a as j}from"./chunk-5ZBA7CN6.js";import{b as G,c as R,d as M,f as O}from"./chunk-GAMVPAQP.js";import{Ba as A,D as p,Fa as D,G as s,Ga as S,H as m,Qa as P,T as h,U as f,aa as y,ia as g,l as C,ma as v,na as F,oa as _,pa as o,qa as i,ra as u,sa as x,ta as d,ya as w,za as n}from"./chunk-LFJQS5LE.js";function W(c,r){if(c&1&&u(0,"app-tag",15),c&2){let e=r.$implicit;g("tagName",e.name)}}var H=class c{profileUpdateForm;fb=p(N);userApi=p(z);categoryApi=p(J);bottomSheetService=p(O);modalReactiveService=p(R);get categoryArray(){return this.profileUpdateForm.get("categories")}constructor(){this.profileUpdateForm=this.fb.group({nickname:"",bio:"",categories:this.fb.array([]),file:""}),C({profile:this.userApi.getProfile(),tags:this.categoryApi.fetchFavCategories()}).subscribe(({profile:r,tags:e})=>{this.profileUpdateForm.patchValue({nickname:r.nickname,bio:r.bio}),e.forEach(t=>this.categoryArray.push(this.fb.control(t)))})}onFileSelected(r){let e=r.target;if(e.files&&e.files.length>0){let t=e.files[0];this.profileUpdateForm.patchValue({file:t}),new FileReader().readAsDataURL(t),console.log(this.profileUpdateForm.value)}}updateCategory(){let r=this.categoryArray.value;this.bottomSheetService.open(L,r).subscribe(e=>{e&&(this.categoryArray.clear(),e.forEach(t=>this.categoryArray.push(this.fb.control(t))))})}updateProfile(){let{nickname:r,bio:e}=this.profileUpdateForm.value,t=this.profileUpdateForm.get("categories")?.value.map(l=>l.categoryId),a={nickname:r,bio:e,categoryIds:JSON.stringify(t)};this.userApi.updateProfile(a).subscribe(()=>{let l={title:"\uD504\uB85C\uD544 \uD3B8\uC9D1 \uC644\uB8CC",subTitle:"\uD504\uB85C\uD544 \uD3B8\uC9D1\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",content:"\uD655\uC778 \uBC84\uD2BC\uC744 \uB204\uB974\uC2DC\uBA74 \uD648 \uD654\uBA74\uC73C\uB85C \uB3CC\uC544\uAC11\uB2C8\uB2E4. \uD655\uC778\uBC84\uD2BC\uC744 \uB20C\uB7EC\uC8FC\uC138\uC694."};this.modalReactiveService.open(l)})}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=y({type:c,selectors:[["profile-update-page"]],decls:31,vars:5,consts:[["fileInput",""],[1,"flex","flex-col","min-h-screen","bg-secondary5","border-x"],[1,"sticky","top-0","z-10","flex","items-center","w-full","gap-3","px-4","py-5","bg-white","border-b","shadow-sm"],[1,"text-xl","font-bold"],[1,"flex","flex-col","flex-1","w-full","gap-5","px-4","py-6"],[1,"relative","mx-auto","w-fit"],["alt","\uC0AC\uC6A9\uC790 \uD504\uB85C\uD544 \uC774\uBBF8\uC9C0",1,"block","mx-auto","bg-white","rounded-full","h-28","w-28",3,"src"],[1,"absolute","bottom-0","right-0","w-12","h-12","bg-white","border","rounded-full","hover:bg-blue-500",3,"click"],["type","file","accept","image/*","hidden","",3,"change"],[3,"formGroup"],[1,"flex","flex-col"],["for","nickname"],["type","text","formControlName","nickname"],["formControlName","bio","rows","10",1,"p-2","border","border-black","rounded-lg","resize-none"],[1,"flex","gap-2"],["appearance","outline","size","s",3,"tagName"],[1,"flex","flex-col","gap-2"],["text","\uAD00\uC2EC\uD0DC\uADF8 \uBCC0\uACBD","width","full",1,"w-full",3,"click"],["text","\uD504\uB85C\uD544 \uD3B8\uC9D1 \uC644\uB8CC","width","full",1,"w-full",3,"click"],[1,"sticky","bottom-0","mt-auto"]],template:function(e,t){if(e&1){let a=x();o(0,"div",1)(1,"header",2)(2,"button",3),n(3,"<"),i(),o(4,"span",3),n(5,"\uD504\uB85C\uD544 \uC218\uC815"),i()(),o(6,"div",4)(7,"div",5),u(8,"img",6),o(9,"button",7),d("click",function(){s(a);let b=w(12);return m(b.click())}),n(10,"+"),i(),o(11,"input",8,0),d("change",function(b){return s(a),m(t.onFileSelected(b))}),i()(),o(13,"form",9)(14,"div",10)(15,"label",11),n(16,"\uB2C9\uB124\uC784"),i(),u(17,"input",12),i(),o(18,"div",10)(19,"label",11),n(20,"\uC790\uAE30\uC18C\uAC1C"),i(),u(21,"textarea",13),i()(),o(22,"div",14),F(23,W,1,1,"app-tag",15,v),i(),n(25),D(26,"json"),o(27,"div",16)(28,"app-button",17),d("click",function(){return s(a),m(t.updateCategory())}),i(),o(29,"app-button",18),d("click",function(){return s(a),m(t.updateProfile())}),i()()(),u(30,"app-footer",19),i()}e&2&&(f(8),g("src",t.profileUpdateForm.value.file,h),f(5),g("formGroup",t.profileUpdateForm),f(10),_(t.categoryArray.value),f(2),A(" ",S(26,3,t.profileUpdateForm.value)," "))},dependencies:[M,G,j,I,B,U,k,E,T,V,P],encapsulation:2})};export{H as ProfileUpdatePage};
