import{b as G}from"./chunk-ZWZ4B73B.js";import{b as A,c as f,d as S,e as V,f as E,g as B,h as M,i as N,k as T,l as _,n as I}from"./chunk-NLQUPEL3.js";import{b as C}from"./chunk-GAMVPAQP.js";import{Aa as y,D as s,U as p,_a as l,aa as u,ea as b,hb as c,ia as g,ib as O,la as x,m as h,pa as i,qa as r,ra as m,ta as D,ua as F,x as v,za as a}from"./chunk-LFJQS5LE.js";function k(o,e){if(o&1&&(i(0,"p",2),a(1),r()),o&2){let t=F();p(),y(t.getErrorMessage())}}var d=class o{email="";otpForm;timeLeft=300;timerSubscription;authApi=s(c);router=s(l);errorMessages={required:"otp\uC778\uC99D\uC740 \uD544\uC218\uC785\uB2C8\uB2E4.",pattern:"\uC22B\uC790\uB9CC \uC785\uB825\uD574\uC8FC\uC138\uC694.",minlength:"\uCD5C\uC18C 6\uAE00\uC790\uC785\uB2C8\uB2E4."};get formattedTime(){let e=Math.floor(this.timeLeft/60),t=this.timeLeft%60;return`${e}\uBD84 ${t<10?"0":""}${t}\uCD08`}constructor(){this.otpForm=new E({otp:new B(null,{validators:[f.required,f.minLength(6),f.pattern(G)],updateOn:"change"})});let e=this.router.getCurrentNavigation();this.email=e?.extras?.state?.email||null}ngOnInit(){this.startTimer()}startTimer(){this.timerSubscription=h(1e3).pipe(v(()=>this.timeLeft>0)).subscribe(()=>{this.timeLeft--})}onVerify(){let e=this.otpForm.getRawValue().otp,t={email:this.email,otp:e};this.authApi.verifyOtp(t).subscribe(n=>{O.getInstance().store(n),this.router.navigateByUrl("/onboarding")})}getErrorMessage(){let e=this.otpForm.get("otp");if(e?.invalid){if(e.hasError("required")&&!e.touched)return null;let t=Object.keys(e.errors||{})[0];return this.errorMessages[t]||null}return null}ngOnDestroy(){this.timerSubscription&&this.timerSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=u({type:o,selectors:[["otp-verify-form"]],decls:8,vars:4,consts:[[1,"flex","flex-col","gap-4",3,"formGroup"],["type","string","minlength","6","formControlName","otp",1,"w-full"],[1,"mt-1","ml-1","text-xs","text-red-600"],[1,"text-red-600"],["text","\uC778\uC99D\uD558\uAE30",3,"click","isDisabled"]],template:function(t,n){t&1&&(i(0,"form",0),m(1,"input",1),b(2,k,2,1,"p",2),i(3,"span"),a(4,"\uB0A8\uC740 \uC785\uB825\uC2DC\uAC04: "),i(5,"span",3),a(6),r()(),i(7,"app-button",4),D("click",function(){return n.onVerify()}),r()()),t&2&&(g("formGroup",n.otpForm),p(2),x(n.getErrorMessage()?2:-1),p(4),y(n.formattedTime),p(),g("isDisabled",n.otpForm.invalid))},dependencies:[I,M,A,S,V,_,N,T,C],encapsulation:2})};var L=class o{authApi=s(c);router=s(l);constructor(){let t=this.router.getCurrentNavigation()?.extras?.state?.email||null;this.authApi.generateOtp({email:t}).subscribe()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=u({type:o,selectors:[["otp-verify-page"]],decls:10,vars:0,consts:[[1,"flex","flex-col","min-h-screen","gap-5","px-4","pt-10","bg-secondary5"],[1,"text-3xl","font-bold"],[1,"mt-1"],[1,"mt-10"],["text","\uC778\uC99D\uCF54\uB4DC \uC7AC\uC694\uCCAD"]],template:function(t,n){t&1&&(i(0,"section",0)(1,"div")(2,"h1",1),a(3,"OTP \uC778\uC99D"),r(),i(4,"p",2),a(5,"\uC774\uBA54\uC77C \uD655\uC778 \uD6C4, \uC778\uC99D \uCF54\uB4DC\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694!"),r()(),m(6,"otp-verify-form"),i(7,"p",3),a(8,"\uC778\uC99D\uCF54\uB4DC\uAC00 \uAC00\uC9C0 \uC54A\uC558\uB098\uC694 ?"),r(),m(9,"app-button",4),r())},dependencies:[d,C],encapsulation:2})};export{L as OtpVerifyPage};
