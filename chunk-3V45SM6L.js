import{a as W}from"./chunk-YY2OMW4C.js";import{a as O}from"./chunk-WLREW4AM.js";import{a as j}from"./chunk-QZQ57QC5.js";import{a as D,d as N,e as S,h as G,i as E,j as k,k as w,m as T,n as M,p as R,q as L,t as V}from"./chunk-MJMJ6QEK.js";import"./chunk-LCXEAPVZ.js";import"./chunk-ES77FXIX.js";import{e as U,q as I,s as _}from"./chunk-PWXOGFPV.js";import{Ab as x,Ea as C,Fb as F,Gb as P,Ia as u,Ta as f,Za as g,a as m,b as c,ba as p,fb as s,ib as B,jb as b,kb as h,lb as v,mb as a,nb as r,ob as n,qb as A,rb as y,yb as l}from"./chunk-4S75Y5RT.js";function H(i,t){if(i&1&&n(0,"img",4),i&2){let e=y();s("src",e.previewUrl,C)}}function J(i,t){i&1&&(a(0,"div",5)(1,"p"),l(2,"\uBBF8\uB9AC\uBCF4\uAE30 \uC0AC\uC9C4\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),r()())}function $(i,t){if(i&1&&(a(0,"div",10)(1,"div"),n(2,"input",13),a(3,"span",14),l(4,"\uB178\uCD9C"),r()(),n(5,"app-input",15),r()),i&2){let e=t.$implicit;s("formGroup",e)}}var z=class i{postId=void 0;collectionId=void 0;previewUrl=null;postUpdateForm;route=p(I);router=p(_);fb=p(T);postApi=p(W);modalReactiveService=p(L);get metadataArray(){return this.postUpdateForm.get("metadataList")}constructor(){this.postUpdateForm=this.fb.group({title:"",content:"",metadataList:this.fb.array([])});let t=this.router.getCurrentNavigation()?.extras.state;this.collectionId=t?.collectionId,this.postId=t?.postId}ngOnInit(){this.collectionId&&this.postId?this.postApi.getPost(this.collectionId,this.postId).subscribe(t=>{this.postUpdateForm.patchValue({title:t?.title,content:t?.content,file:""}),t?.metadataList.forEach(e=>this.addMetadata(e.content,e.isPublic)),this.previewUrl=t?.imageUrl,this.addMetadata()}):console.log("\uC0AC\uC9C4\uCCA9 Id \uB610\uB294 \uAC8C\uC2DC\uBB3C Id\uAC00 \uC774\uC0C1\uD569\uB2C8\uB2E4!")}addMetadata(t="",e=!1){let o=this.fb.group({content:[t],isPublic:[e]});this.metadataArray.push(o)}updatePost(){let t=this.postUpdateForm.getRawValue(),e=c(m({},t),{metadataList:t.metadataList.filter(o=>o.content.trim()!=="")});this.postApi.updatePost(this.postId,e).subscribe(()=>{let o={title:"\uAC8C\uC2DC\uBB3C \uC218\uC815 \uC644\uB8CC",subTitle:"\uAC8C\uC2DC\uBB3C \uC218\uC815\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",content:"\uD655\uC778 \uBC84\uD2BC\uC744 \uB204\uB974\uC2DC\uBA74 \uD648 \uD654\uBA74\uC73C\uB85C \uB3CC\uC544\uAC11\uB2C8\uB2E4. \uD655\uC778\uBC84\uD2BC\uC744 \uB20C\uB7EC\uC8FC\uC138\uC694.",buttons:["\uD655\uC778"]};this.modalReactiveService.open(o).subscribe(d=>{console.log("\uC120\uD0DD\uB41C \uBC84\uD2BC:",d)})})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["post-update-page"]],decls:17,vars:5,consts:[[1,"flex","flex-col","min-h-screen","border-x","bg-secondary5"],["title","\uAC8C\uC2DC\uBB3C \uC218\uC815"],[1,"flex-1","w-full","px-4","py-6"],[1,"flex","flex-col","gap-5",3,"formGroup"],["alt","\uC784\uC2DC \uC774\uBBF8\uC9C0",1,"h-[485px]","rounded-lg",3,"src"],[1,"flex","h-[485px]","items-center","justify-center","rounded-lg","border","bg-gray20"],["label","\uAC8C\uC2DC\uBB3C \uC81C\uBAA9","placeholder","\uAC8C\uC2DC\uBB3C \uC81C\uBAA9\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.","formControlName","title"],["type","textarea","label","\uAC8C\uC2DC\uBB3C \uB0B4\uC6A9","placeholder","\uAC8C\uC2DC\uBB3C \uB0B4\uC6A9\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.","formControlName","content"],["formArrayName","metadataList"],[1,"block","mb-3"],[1,"flex","gap-3","mb-3","last-of-type:mb-0",3,"formGroup"],["text","\uC218\uC815\uB41C \uB0B4\uC6A9 \uC800\uC7A5","width","full",3,"click"],[1,"sticky","bottom-0","mt-auto"],["formControlName","isPublic","type","checkbox",1,"w-6","h-6"],[1,"block","text-sm"],["formControlName","content","inputType","text","placeholder","\uC0AC\uC9C4\uB0B4\uC6A9",1,"flex-1"]],template:function(e,o){e&1&&(a(0,"div",0),n(1,"app-header",1),a(2,"div",2)(3,"form",3),g(4,H,1,1,"img",4)(5,J,3,0,"div",5),n(6,"app-input",6)(7,"app-input",7),a(8,"div",8)(9,"span",9),l(10,"\uC0AC\uC9C4\uB0B4\uC6A9"),r(),h(11,$,6,1,"div",10,b),r(),a(13,"app-button",11),A("click",function(){return o.updatePost()}),r()()(),l(14),F(15,"json"),n(16,"app-footer",12),r()),e&2&&(u(3),s("formGroup",o.postUpdateForm),u(),B(o.previewUrl?4:5),u(7),v(o.metadataArray.controls),u(3),x(" ",P(15,3,o.postUpdateForm.value)," "))},dependencies:[R,O,M,G,D,N,S,E,w,k,U,j,V],encapsulation:2})};export{z as PostUpdatePage};
