import{a as ee}from"./chunk-HGW2SKTM.js";import{a as V}from"./chunk-YY2OMW4C.js";import{a as Z}from"./chunk-H7GYVJWJ.js";import{a as K}from"./chunk-L7WU3QFJ.js";import"./chunk-LPABG7ES.js";import"./chunk-5VEL7C3W.js";import"./chunk-KXLXBALE.js";import{a as W}from"./chunk-IZOR5LZS.js";import{a as Q}from"./chunk-WLREW4AM.js";import{a as $}from"./chunk-QZQ57QC5.js";import{p as D}from"./chunk-MJMJ6QEK.js";import"./chunk-LCXEAPVZ.js";import{b as H}from"./chunk-OF7MEPLT.js";import"./chunk-ES77FXIX.js";import"./chunk-5BF4NUEH.js";import{q as z,s as R}from"./chunk-PWXOGFPV.js";import{Cb as k,Ea as A,Ia as s,Ta as M,Za as P,ba as d,d as I,fb as u,ib as L,ja as g,jb as S,ka as f,kb as T,lb as O,mb as r,nb as a,ob as p,pb as C,qb as v,rb as y,ub as b,vb as x,wb as w,yb as E,zb as _}from"./chunk-4S75Y5RT.js";var N=["grid"],j=["item"],X=()=>[];function Y(l,t){if(l&1&&(r(0,"app-header",3),p(1,"app-tag",11),a()),l&2){let e=y();u("title",e.collection.title),s(),u("appearance","outline")("tagName",(e.collection.category==null?null:e.collection.category.name)||"")}}function J(l,t){if(l&1){let e=C();r(0,"div",12,1),v("click",function(){let n=g(e).$implicit,o=y();return f(o.goPage(n.postId))}),p(2,"img",13),r(3,"div",14)(4,"span",15),E(5),a(),r(6,"p",16),E(7),a()()()}if(l&2){let e=t.$implicit;s(2),u("src",e.imageUrl,A)("alt",e.title),s(3),_(e.title),s(2),_(e.content)}}var F=class l{grid;items;collection=void 0;postList=void 0;columnWidth=150;columnGap=16;rowGap=16;collectionId=void 0;router=d(R);route=d(z);collectionApi=d(W);postApi=d(V);resizeObserver=null;constructor(){}ngOnInit(){this.collectionId=this.route.snapshot.paramMap.get("id"),this.collectionId&&(this.collectionApi.getCollection(this.collectionId).subscribe(t=>{this.collection=t}),this.postApi.getCollection(this.collectionId).subscribe(t=>{this.postList=t?.items,this.items.changes.subscribe(()=>{this.items.length>0&&this.initializeLayout()})}))}initializeLayout(){return I(this,null,function*(){this.wrapAllItems(),yield this.waitForImagesToLoad(),this.positionAllItems(),this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(()=>{this.positionAllItems()}),this.resizeObserver.observe(this.grid.nativeElement)})}goPage(t){this.router.navigateByUrl(`post/${t}`,{state:{collectionId:this.collection?.collectionId}})}goUpdatePage(){this.router.navigateByUrl(`collection/update/${this.collectionId}`)}positionAllItems(){let t=this.grid.nativeElement.clientWidth,e=this.columnWidth+this.columnGap,i=Math.max(1,Math.floor(t/e)),n=this.grid.nativeElement.querySelector(".container");n.style.width=e*i-this.columnGap+"px";let o=Array(i).fill(0);this.items.forEach(G=>{let c=G.nativeElement.closest(".brick");c.style.position="absolute",c.style.width=`${this.columnWidth}px`,c.style.left="0",c.style.top="0";let U=c.offsetHeight+this.rowGap,h=this.findMinIndex(o),q=h*e,B=o[h];o[h]+=U,this.setElementStyle(c,{position:"absolute",width:`${this.columnWidth}px`,left:`${q}px`,top:`${B}px`,transition:"transform 0.3s ease"})});let m=Math.max(...o);n.style.height=m+"px"}wrapAllItems(){let t=this.grid.nativeElement.querySelector(".container");t&&t.remove();let e=document.createElement("div");e.classList.add("container"),this.setElementStyle(e,{position:"relative",margin:"0 auto"}),this.items.forEach(i=>{let n=document.createElement("div");n.classList.add("wrapper"),this.setElementStyle(n,{padding:`0 ${this.columnGap/2}px ${this.rowGap}px`});let o=i.nativeElement;n.appendChild(o);let m=document.createElement("div");m.classList.add("brick"),m.appendChild(n),e.appendChild(m)}),this.grid.nativeElement.appendChild(e)}setElementStyle(t,e){Object.assign(t.style,e)}findMinIndex(t){return t.indexOf(Math.min(...t))}waitForImagesToLoad(){let t=Array.from(this.grid.nativeElement.querySelectorAll("img"));return Promise.all(t.map(e=>new Promise(i=>{e.complete?i():(e.onload=()=>i(),e.onerror=()=>i())})))}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=M({type:l,selectors:[["app-collection-main"]],viewQuery:function(e,i){if(e&1&&(b(N,5),b(j,5)),e&2){let n;x(n=w())&&(i.grid=n.first),x(n=w())&&(i.items=n)}},decls:11,vars:2,consts:[["grid",""],["item",""],[1,"flex","flex-col","min-h-screen","border-x","bg-secondary5"],[3,"title"],[1,"grid","grid-cols-3","gap-3","p-4","bg-white","border-b"],["text","\uC0AC\uC9C4\uCCA9 \uC0AD\uC81C","appearance","secondary"],["text","\uC0AC\uC9C4\uCCA9 \uC218\uC815","appearance","secondary",3,"click"],["text","\uC0AC\uC9C4\uCCA9 \uC815\uB9AC","appearance","secondary"],[1,"pt-4"],[1,"bg-white","rounded-lg","shadow-lg","cursor-pointer","hover:shadow-2xl"],[1,"sticky","bottom-0","mt-auto"],["rightContent","","size","m",1,"ml-auto",3,"appearance","tagName"],[1,"bg-white","rounded-lg","shadow-lg","cursor-pointer","hover:shadow-2xl",3,"click"],[1,"rounded-t-lg",3,"src","alt"],[1,""],[1,"text-lg","font-bold"],[1,"text-sm","line-clamp-2"]],template:function(e,i){if(e&1){let n=C();r(0,"div",2),P(1,Y,2,3,"app-header",3),r(2,"div",4),p(3,"app-button",5),r(4,"app-button",6),v("click",function(){return g(n),f(i.goUpdatePage())}),a(),p(5,"app-button",7),a(),r(6,"main",8,0),T(8,J,8,4,"div",9,S),a(),p(10,"app-footer",10),a()}e&2&&(s(),L(i.collection?1:-1),s(7),O(i.postList||k(1,X)))},dependencies:[H,Q,D,$],encapsulation:2})};export{Z as CollectionCreatePage,K as CollectionFormComponent,F as CollectionMainPage,ee as CollectionUpdatePage};
