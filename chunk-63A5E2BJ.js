import{a as O}from"./chunk-YY2OMW4C.js";import{a as J}from"./chunk-AYOMIFAR.js";import"./chunk-7KJGLARE.js";import{a as L}from"./chunk-IZOR5LZS.js";import{a as W}from"./chunk-WLREW4AM.js";import{a as H}from"./chunk-QZQ57QC5.js";import{a as k,d as T,e as V,h as I,i as N,j as G,k as M,m as R,n as U,p as z,q as $,t as j}from"./chunk-MJMJ6QEK.js";import"./chunk-LCXEAPVZ.js";import"./chunk-OF7MEPLT.js";import"./chunk-ES77FXIX.js";import"./chunk-5BF4NUEH.js";import{e as S}from"./chunk-PWXOGFPV.js";import{Ab as D,Ea as A,Fb as w,Gb as E,Ia as l,Oa as P,Ta as F,Za as x,ba as m,fb as u,ib as h,ja as d,jb as b,ka as f,kb as v,lb as y,mb as r,nb as n,ob as s,pb as g,qb as _,rb as c,yb as p,zb as B}from"./chunk-4S75Y5RT.js";function Q(i,t){if(i&1&&s(0,"img",8),i&2){let e=c(2);u("src",e.previewUrl,A)}}function X(i,t){i&1&&(r(0,"div",9)(1,"p"),p(2,"\uC0AC\uC9C4\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694."),n()())}function Y(i,t){if(i&1&&(r(0,"div",14)(1,"div"),s(2,"input",16),r(3,"span",17),p(4,"\uB178\uCD9C"),n()(),s(5,"app-input",18),n()),i&2){let e=t.$implicit;u("formGroup",e)}}function Z(i,t){if(i&1){let e=g();r(0,"form",5)(1,"input",7),_("change",function(a){d(e);let C=c();return f(C.upload(a))}),n(),x(2,Q,1,1,"img",8)(3,X,3,0,"div",9),s(4,"app-input",10)(5,"app-input",11),r(6,"div",12)(7,"span",13),p(8,"\uC0AC\uC9C4\uB0B4\uC6A9"),n(),v(9,Y,6,1,"div",14,b),n(),r(11,"app-button",15),_("click",function(){d(e);let a=c();return f(a.updateState())}),n()()}if(i&2){let e=c();u("formGroup",e.postCreateForm),l(2),h(e.previewUrl?2:3),l(7),y(e.metadataArray.controls)}}function ee(i,t){if(i&1){let e=g();r(0,"div",20)(1,"input",22),_("change",function(a){let C=d(e).$implicit,K=c(2);return f(K.selectCollection(C.id,a))}),n(),s(2,"app-collection-card",23),n()}if(i&2){let e=t.$implicit,o=c(2);l(),u("checked",o.postCreateForm.value.collectionId===e.id),l(),u("post",e)}}function te(i,t){if(i&1){let e=g();r(0,"div",19),v(1,ee,3,2,"div",20,b),n(),r(3,"app-button",21),_("click",function(){d(e);let a=c();return f(a.createCollection())}),n()}if(i&2){let e=c();l(),y(e.collections)}}var q=class i{step=P(1);previewUrl=null;postCreateForm;collections=[];fb=m(R);postApi=m(O);collectionApi=m(L);modalReactiveService=m($);get metadataArray(){return this.postCreateForm.get("metadataStringify")}constructor(){this.postCreateForm=this.fb.group({collectionId:"",title:"",content:"",metadataStringify:this.fb.array([]),file:""}),this.initializeMetadata(),this.collectionApi.getCollections().subscribe(t=>{this.collections=t.items})}ngOnInit(){}upload(t){let e=t.target;if(e.files&&e.files[0]){let o=e.files[0];this.postCreateForm.patchValue({file:o}),console.log(this.postCreateForm.value);let a=new FileReader;a.onload=C=>{this.previewUrl=C.target?.result},a.readAsDataURL(o)}}initializeMetadata(){Array.from({length:4},(e,o)=>({content:`(\uC784\uC2DC) \uC0AC\uC9C4\uB0B4\uC6A9 ${o+1}`,isPublic:!1})).forEach(e=>this.addMetadata(e.content,e.isPublic))}addMetadata(t="",e=!1){let o=this.fb.group({content:[t],isPublic:[e]});this.metadataArray.push(o)}updateState(){this.step.set(2)}selectCollection(t,e){e.target.checked?this.postCreateForm.patchValue({collectionId:t}):this.postCreateForm.patchValue({collectionId:""})}createCollection(){let t=this.postCreateForm.getRawValue();console.log(t),this.postApi.createPost(t).subscribe(()=>{let e={title:"\uAC8C\uC2DC\uBB3C \uC0DD\uC131 \uC644\uB8CC",subTitle:"\uAC8C\uC2DC\uBB3C \uC0DD\uC131\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",content:"\uD655\uC778 \uBC84\uD2BC\uC744 \uB204\uB974\uC2DC\uBA74 \uD648 \uD654\uBA74\uC73C\uB85C \uB3CC\uC544\uAC11\uB2C8\uB2E4. \uD655\uC778\uBC84\uD2BC\uC744 \uB20C\uB7EC\uC8FC\uC138\uC694.",buttons:["\uD655\uC778"]};this.modalReactiveService.open(e).subscribe(o=>{console.log("\uC120\uD0DD\uB41C \uBC84\uD2BC:",o)})})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=F({type:i,selectors:[["post-create-page"]],decls:12,vars:5,consts:[[1,"flex","flex-col","min-h-screen","border-x","bg-secondary5"],["title","\uAC8C\uC2DC\uBB3C \uC0DD\uC131"],["rightContent","",1,"flex"],[1,"font-bold"],[1,"flex-1","w-full","px-4","py-6"],[1,"flex","flex-col","gap-5",3,"formGroup"],[1,"sticky","bottom-0","mt-auto"],["type","file",3,"change"],["alt","\uC784\uC2DC \uC774\uBBF8\uC9C0",1,"h-[485px]","rounded-lg",3,"src"],[1,"flex","h-[485px]","items-center","justify-center","rounded-lg","border","bg-gray20"],["label","\uAC8C\uC2DC\uBB3C \uC81C\uBAA9","placeholder","\uAC8C\uC2DC\uBB3C \uC81C\uBAA9\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.","formControlName","title"],["type","textarea","label","\uAC8C\uC2DC\uBB3C \uB0B4\uC6A9","placeholder","\uAC8C\uC2DC\uBB3C \uB0B4\uC6A9\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.","formControlName","content"],["formArrayName","metadataStringify"],[1,"block","mb-3"],[1,"flex","gap-3","mb-3","last-of-type:mb-0",3,"formGroup"],["text","\uB2E4\uC74C \uB2E8\uACC4\uB85C","width","full",3,"click"],["formControlName","isPublic","type","checkbox",1,"w-6","h-6"],[1,"block","text-sm"],["formControlName","content",1,"flex-1"],[1,"grid","grid-cols-2","gap-5","pb-5"],[1,""],["text","\uC120\uD0DD\uD55C \uC0AC\uC9C4\uCCA9\uC5D0 \uC800\uC7A5","width","full",1,"mt-5",3,"click"],["type","checkbox",1,"absolute","z-20","w-6","h-6",3,"change","checked"],[3,"post"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"app-header",1)(2,"span",2)(3,"span",3),p(4),n(),p(5," /2 "),n()(),r(6,"div",4),x(7,Z,12,2,"form",5)(8,te,4,0),n(),p(9),w(10,"json"),s(11,"app-footer",6),n()),e&2&&(l(4),B(o.step()),l(3),h(o.step()===1?7:8),l(2),D(" ",E(10,3,o.postCreateForm.value)," "))},dependencies:[z,W,U,I,k,T,V,N,M,G,S,J,H,j],encapsulation:2})};export{q as PostCreatePage};
